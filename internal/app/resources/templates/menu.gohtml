{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Dynamic menu dispatcher â€“ choose a role-specific sub-template at runtime
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu" }}
  {{ if eq .Role "superadmin" }}
    {{ template "menu_superadmin" . }}
  {{ else if eq .Role "admin" }}
    {{ template "menu_admin" . }}
  {{ else if eq .Role "analyst" }}
    {{ template "menu_analyst" . }}
  {{ else if eq .Role "coordinator" }}
    {{ template "menu_coordinator" . }}
  {{ else if eq .Role "leader" }}
    {{ template "menu_leader" . }}
  {{ else if eq .Role "member" }}
    {{ template "menu_member" . }}
  {{ else }}
    {{ template "menu_visitor" . }}
  {{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  SuperAdmin  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_superadmin" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">StrataHub</h1>
    <span class="menu-text text-xs text-gray-500 dark:text-gray-400">SuperAdmin</span>
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/workspaces" title="Workspaces"><span class="menu-icon mr-2">ğŸ </span><span class="menu-text">Workspaces</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/admin/status" title="System Status"><span class="menu-icon mr-2">ğŸ”§</span><span class="menu-text">Status</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/profile" title="Profile"><span class="menu-icon mr-2">ğŸ‘¤</span><span class="menu-text">Profile</span></a>
  <a class="menu-link flex items-center text-red-500 dark:text-red-400 hover:underline" href="/logout" title="Logout"><span class="menu-icon mr-2">ğŸšª</span><span class="menu-text">Logout</span></a>
</nav>

{{ if .IsLoggedIn }}
  <a href="/profile" class="menu-user-info block mt-4 pt-4 border-t border-b border-gray-200 dark:border-gray-700 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 -mx-2 px-2" style="padding-bottom: 1rem;" title="View Profile">
    <div class="font-semibold truncate text-gray-700 dark:text-gray-300">{{ .UserName }}</div>
    <div class="text-gray-500 dark:text-gray-500">{{ .Role }}</div>
  </a>
{{ template "menu_footer_no_border" }}
{{ else }}
{{ template "menu_footer" }}
{{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Admin  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_admin" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    {{ if .LogoURL }}
      <img src="{{ .LogoURL }}" alt="{{ .SiteName }}" class="menu-logo h-10 w-auto object-contain">
    {{ end }}
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">{{ if .SiteName }}{{ .SiteName }}{{ else }}StrataHub{{ end }}</h1>
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/dashboard" title="Dashboard"><span class="menu-icon mr-2">ğŸ›ï¸</span><span class="menu-text">Dashboard</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/activity" title="Activity"><span class="menu-icon mr-2">ğŸ“Š</span><span class="menu-text">Activity</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/reports/members" title="Members Report"><span class="menu-icon mr-2">ğŸ“ˆ</span><span class="menu-text">Members Report</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/organizations" title="Organizations"><span class="menu-icon mr-2">ğŸ¢</span><span class="menu-text">Organizations</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/groups" title="Groups"><span class="menu-icon mr-2">ğŸ‘¥</span><span class="menu-text">Groups</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/leaders" title="Leaders"><span class="menu-icon mr-2">ğŸ‘‘</span><span class="menu-text">Leaders</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/members" title="Members"><span class="menu-icon mr-2">â›¹ï¸</span><span class="menu-text">Members</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/upload_csv?allowGroup=true" title="Upload CSV"><span class="menu-icon mr-2">ğŸ“¤</span><span class="menu-text">Upload CSV</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/system-users" title="System Users"><span class="menu-icon mr-2">ğŸ§‘â€ğŸ’»</span><span class="menu-text">System Users</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/resources" title="Resources"><span class="menu-icon mr-2">ğŸ“š</span><span class="menu-text">Resources</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/materials" title="Materials"><span class="menu-icon mr-2">ğŸ“</span><span class="menu-text">Materials</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/audit" title="Audit Log"><span class="menu-icon mr-2">ğŸ“‹</span><span class="menu-text">Audit Log</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/dashboard/sessions" title="Active Sessions"><span class="menu-icon mr-2">ğŸ–¥ï¸</span><span class="menu-text">Sessions</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/announcements" title="Create &amp; Manage Announcements"><span class="menu-icon mr-2">ğŸ“¢</span><span class="menu-text">Announce</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/mhsdashboard" title="MHS Dashboard"><span class="menu-icon mr-2">ğŸ’§</span><span class="menu-text">MHS Dashboard</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/mhs/units" title="MHS Units"><span class="menu-icon mr-2">ğŸ®</span><span class="menu-text">MHS Units</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/admin/status" title="System Status"><span class="menu-icon mr-2">ğŸ”§</span><span class="menu-text">Status</span></a>
  {{ template "menu_common" . }}
</nav>

{{ if .IsLoggedIn }}
  <a href="/profile" class="menu-user-info block mt-4 pt-4 border-t border-b border-gray-200 dark:border-gray-700 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 -mx-2 px-2" style="padding-bottom: 1rem;" title="View Profile">
    <div class="font-semibold truncate text-gray-700 dark:text-gray-300">{{ .UserName }}</div>
    <div class="text-gray-500 dark:text-gray-500">{{ .Role }}</div>
  </a>
{{ template "menu_footer_no_border" }}
{{ else }}
{{ template "menu_footer" }}
{{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Analyst  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_analyst" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    {{ if .LogoURL }}
      <img src="{{ .LogoURL }}" alt="{{ .SiteName }}" class="menu-logo h-10 w-auto object-contain">
    {{ end }}
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">{{ if .SiteName }}{{ .SiteName }}{{ else }}StrataHub{{ end }}</h1>
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/dashboard" title="Dashboard"><span class="menu-icon mr-2">ğŸ›ï¸</span><span class="menu-text">Dashboard</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/reports/members" title="Members Report"><span class="menu-icon mr-2">ğŸ“ˆ</span><span class="menu-text">Members Report</span></a>
  {{ template "menu_common" . }}
</nav>

{{ if .IsLoggedIn }}
  <a href="/profile" class="menu-user-info block mt-4 pt-4 border-t border-b border-gray-200 dark:border-gray-700 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 -mx-2 px-2" style="padding-bottom: 1rem;" title="View Profile">
    <div class="font-semibold truncate text-gray-700 dark:text-gray-300">{{ .UserName }}</div>
    <div class="text-gray-500 dark:text-gray-500">{{ .Role }}</div>
  </a>
{{ template "menu_footer_no_border" }}
{{ else }}
{{ template "menu_footer" }}
{{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Coordinator  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_coordinator" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    {{ if .LogoURL }}
      <img src="{{ .LogoURL }}" alt="{{ .SiteName }}" class="menu-logo h-10 w-auto object-contain">
    {{ end }}
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">{{ if .SiteName }}{{ .SiteName }}{{ else }}StrataHub{{ end }}</h1>
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/dashboard" title="Dashboard"><span class="menu-icon mr-2">ğŸ›ï¸</span><span class="menu-text">Dashboard</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/activity" title="Activity"><span class="menu-icon mr-2">ğŸ“Š</span><span class="menu-text">Activity</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/reports/members" title="Members Report"><span class="menu-icon mr-2">ğŸ“ˆ</span><span class="menu-text">Members Report</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/organizations" title="Organizations"><span class="menu-icon mr-2">ğŸ¢</span><span class="menu-text">Organizations</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/groups" title="Groups"><span class="menu-icon mr-2">ğŸ‘¥</span><span class="menu-text">Groups</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/leaders" title="Leaders"><span class="menu-icon mr-2">ğŸ‘‘</span><span class="menu-text">Leaders</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/members" title="Members"><span class="menu-icon mr-2">â›¹ï¸</span><span class="menu-text">Members</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/upload_csv?allowGroup=true" title="Upload CSV"><span class="menu-icon mr-2">ğŸ“¤</span><span class="menu-text">Upload CSV</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/resources" title="Resources"><span class="menu-icon mr-2">ğŸ“š</span><span class="menu-text">Resources</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/materials" title="Materials"><span class="menu-icon mr-2">ğŸ“</span><span class="menu-text">Materials</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/audit" title="Audit Log"><span class="menu-icon mr-2">ğŸ“‹</span><span class="menu-text">Audit Log</span></a>
  {{ template "menu_common" . }}
</nav>

{{ if .IsLoggedIn }}
  <a href="/profile" class="menu-user-info block mt-4 pt-4 border-t border-b border-gray-200 dark:border-gray-700 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 -mx-2 px-2" style="padding-bottom: 1rem;" title="View Profile">
    <div class="font-semibold truncate text-gray-700 dark:text-gray-300">{{ .UserName }}</div>
    <div class="text-gray-500 dark:text-gray-500">{{ .Role }}</div>
  </a>
{{ template "menu_footer_no_border" }}
{{ else }}
{{ template "menu_footer" }}
{{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Leader  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_leader" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    {{ if .LogoURL }}
      <img src="{{ .LogoURL }}" alt="{{ .SiteName }}" class="menu-logo h-10 w-auto object-contain">
    {{ end }}
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">{{ if .SiteName }}{{ .SiteName }}{{ else }}StrataHub{{ end }}</h1>
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/mhsdashboard" title="MHS Dashboard"><span class="menu-icon mr-2">ğŸ’§</span><span class="menu-text">MHS Dashboard</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/mhs/units" title="Mission HydroSci"><span class="menu-icon mr-2">ğŸ®</span><span class="menu-text">MHS Units</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/activity" title="Activity"><span class="menu-icon mr-2">ğŸ“Š</span><span class="menu-text">Activity</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/leader/materials" title="My Materials"><span class="menu-icon mr-2">ğŸ“</span><span class="menu-text">My Materials</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/my-announcements" title="Announcements"><span class="menu-icon mr-2">ğŸ“¢</span><span class="menu-text">Announcements</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/groups" title="Groups"><span class="menu-icon mr-2">ğŸ‘¥</span><span class="menu-text">Groups</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/members" title="Members"><span class="menu-icon mr-2">â›¹ï¸</span><span class="menu-text">Members</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/upload_csv?allowGroup=true" title="Upload CSV"><span class="menu-icon mr-2">ğŸ“¤</span><span class="menu-text">Upload CSV</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/profile" title="Profile"><span class="menu-icon mr-2">ğŸ‘¤</span><span class="menu-text">Profile</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/about" title="About"><span class="menu-icon mr-2">â„¹ï¸</span><span class="menu-text">About</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/contact" title="Contact"><span class="menu-icon mr-2">ğŸ“§</span><span class="menu-text">Contact</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/terms" title="Terms of Service"><span class="menu-icon mr-2">ğŸ“œ</span><span class="menu-text">Terms</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/privacy" title="Privacy Policy"><span class="menu-icon mr-2">ğŸ”’</span><span class="menu-text">Privacy</span></a>
  <a class="menu-link flex items-center text-red-500 dark:text-red-400 hover:underline" href="/logout" title="Logout"><span class="menu-icon mr-2">ğŸšª</span><span class="menu-text">Logout</span></a>
</nav>

{{ if .IsLoggedIn }}
  <a href="/profile" class="menu-user-info block mt-4 pt-4 border-t border-b border-gray-200 dark:border-gray-700 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 -mx-2 px-2" style="padding-bottom: 1rem;" title="View Profile">
    <div class="font-semibold truncate text-gray-700 dark:text-gray-300">{{ .UserName }}</div>
    {{ if .UserOrg }}<div class="truncate text-gray-500 dark:text-gray-500" title="{{ .UserOrg }}">{{ .UserOrg }}</div>{{ end }}
    <div class="text-gray-500 dark:text-gray-500">{{ .Role }}</div>
  </a>
{{ template "menu_footer_no_border" }}
{{ else }}
{{ template "menu_footer" }}
{{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  Member  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_member" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    {{ if .LogoURL }}
      <img src="{{ .LogoURL }}" alt="{{ .SiteName }}" class="menu-logo h-10 w-auto object-contain">
    {{ end }}
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">{{ if .SiteName }}{{ .SiteName }}{{ else }}StrataHub{{ end }}</h1>
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/dashboard" title="Dashboard"><span class="menu-icon mr-2">ğŸ›ï¸</span><span class="menu-text">Dashboard</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/mhs/units" title="Mission HydroSci"><span class="menu-icon mr-2">ğŸ®</span><span class="menu-text">MHS Units</span></a>
  <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/member/resources" title="Resources"><span class="menu-icon mr-2">ğŸ“š</span><span class="menu-text">Resources</span></a>
  {{ template "menu_common" . }}
</nav>

{{ if .IsLoggedIn }}
  <a href="/profile" class="menu-user-info block mt-4 pt-4 border-t border-b border-gray-200 dark:border-gray-700 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 -mx-2 px-2" style="padding-bottom: 1rem;" title="View Profile">
    <div class="font-semibold truncate text-gray-700 dark:text-gray-300">{{ .UserName }}</div>
    {{ if .UserOrg }}<div class="truncate text-gray-500 dark:text-gray-500" title="{{ .UserOrg }}">{{ .UserOrg }}</div>{{ end }}
    <div class="text-gray-500 dark:text-gray-500">{{ .Role }}</div>
  </a>
{{ template "menu_footer_no_border" }}
{{ else }}
{{ template "menu_footer" }}
{{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Visitor  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_visitor" }}
<div class="mb-2">
  <div class="flex flex-col items-center">
    {{ if .LogoURL }}
      <img src="{{ .LogoURL }}" alt="{{ .SiteName }}" class="menu-logo h-10 w-auto object-contain">
    {{ end }}
    <h1 class="menu-header text-xl font-bold text-indigo-600 dark:text-indigo-400">{{ if .SiteName }}{{ .SiteName }}{{ else }}StrataHub{{ end }}</h1>
    {{ if .IsApex }}<span class="menu-text text-xs text-gray-500 dark:text-gray-400">Workspace Management</span>{{ end }}
  </div>
</div>

<nav class="space-y-2 text-sm flex-1 pt-4 border-t border-gray-200 dark:border-gray-700">
  {{ template "menu_common" . }}
</nav>

{{ template "menu_footer" }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Shared links  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_common" }}
  {{/* Workspace-scoped content pages - hide on apex domain */}}
  {{ if not .IsApex }}
    <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/about" title="About"><span class="menu-icon mr-2">â„¹ï¸</span><span class="menu-text">About</span></a>
    <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/contact" title="Contact"><span class="menu-icon mr-2">ğŸ“§</span><span class="menu-text">Contact</span></a>
    <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/terms" title="Terms of Service"><span class="menu-icon mr-2">ğŸ“œ</span><span class="menu-text">Terms</span></a>
    <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/privacy" title="Privacy Policy"><span class="menu-icon mr-2">ğŸ”’</span><span class="menu-text">Privacy</span></a>
  {{ end }}

  {{ if .IsLoggedIn }}
    {{/* Announcements only on workspace (not apex) */}}
    {{ if not .IsApex }}
      <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/my-announcements" title="Announcements"><span class="menu-icon mr-2">ğŸ“¢</span><span class="menu-text">Announcements</span></a>
    {{ end }}
    <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/profile" title="Profile"><span class="menu-icon mr-2">ğŸ‘¤</span><span class="menu-text">Profile</span></a>
    {{/* Settings only for admin on workspace (not apex) */}}
    {{ if and (eq .Role "admin") (not .IsApex) }}
      <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/settings" title="Workspace Settings"><span class="menu-icon mr-2">âš™ï¸</span><span class="menu-text">Settings</span></a>
    {{ end }}
    <a class="menu-link flex items-center text-red-500 dark:text-red-400 hover:underline" href="/logout" title="Logout"><span class="menu-icon mr-2">ğŸšª</span><span class="menu-text">Logout</span></a>
  {{ else }}
    <a class="menu-link flex items-center text-gray-700 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400" href="/login" title="Login"><span class="menu-icon mr-2">ğŸ”</span><span class="menu-text">Login</span></a>
  {{ end }}
{{ end }}

{{/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Footer with toggle and dark mode  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€*/}}
{{ define "menu_footer" }}
<div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 space-y-2">
  <button id="dark-mode-toggle" class="menu-link flex items-center text-gray-500 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 text-sm w-full" title="Toggle dark mode">
    <span class="menu-icon mr-2" id="dark-mode-icon">ğŸŒ™</span><span class="menu-text" id="dark-mode-text">Dark Mode</span>
  </button>
  <button id="menu-toggle" class="menu-link flex items-center text-gray-500 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 text-sm w-full" title="Toggle sidebar">
    <span class="menu-icon mr-2">â—€</span><span class="menu-text">Collapse</span>
  </button>
</div>
{{ end }}

{{/* Footer without top border (used after user info which has bottom border) */}}
{{ define "menu_footer_no_border" }}
<div class="pt-4 space-y-2">
  <button id="dark-mode-toggle" class="menu-link flex items-center text-gray-500 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 text-sm w-full" title="Toggle dark mode">
    <span class="menu-icon mr-2" id="dark-mode-icon">ğŸŒ™</span><span class="menu-text" id="dark-mode-text">Dark Mode</span>
  </button>
  <button id="menu-toggle" class="menu-link flex items-center text-gray-500 dark:text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400 text-sm w-full" title="Toggle sidebar">
    <span class="menu-icon mr-2">â—€</span><span class="menu-text">Collapse</span>
  </button>
</div>
{{ end }}
